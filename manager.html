<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>fogbow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="http://www.fogbowcloud.org/theme/img/icons/favicon.ico" />
    <link rel="stylesheet" href="http://www.fogbowcloud.org/theme/css/bootstrap.css">
  </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="../" class="navbar-brand">fogbow</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <ul class="nav navbar-nav navbar-right">
          <li >
            <a href="http://www.fogbowcloud.org/install-opportunism.html">Install</a>
          </li>
          <li class="active">
            <a href="http://www.fogbowcloud.org/architecture.html">How it works</a>
          </li>
          <li >
            <a href="http://www.fogbowcloud.org/manager-cli.html">How to use it</a>
          </li>
          <li><a href="#">Contact us</a></li>
        </ul>
      </div>
    </div>
     <div class="container">
      <div class="bs-docs-section">
    <div class="bs-docs-section">
    <div class="row">
      <div class="col-lg-4">
      	<br>
        <ul class="nav nav-pills nav-stacked" style="max-width: 300px;">
            <li >
            	<a href="architecture">General architecture</a>
            </li>
            <li >
            	<a href="rendezvous">Rendezvous</a>
            </li>
            <li class="active">
            	<a href="manager">Manager</a>
            </li>
            <li >
            	<a href="opportunism">Opportunism</a>
            </li>
            <li >
            	<a href="green">Green</a>
            </li>
            <li >
            	<a href="multiplatform">Multiplatform</a>
            </li>
        </ul>
      </div>
      <div class="col-lg-8 page-content">
      	<h1>Manager</h1>
<p>The Manager is the federation service that should run on each federation member. It provides an extended OCCI API for final users and interacts with Rendezvous and other Managers. The final user requests resources through extended OCCI API and specifying the amount of them. The requested resources are treated individually (e.g., if an user requests 3 instances, the manager translates it to 3 single requests of 1 instance). </p>
<p>While there are available resources, the manager creates instances on local cloud. Thereafter it uses information (got from Rendezvous) to choose another manager and submits remaining requests to a remote cloud. This process concludes when the user's requests were fulfilled or they were not into valid period anymore. </p>
<h2>Manager Architecture</h2>
<p>The Manager component was designed to not depend on a specific cloud technology. There is a Plugin Layer between this component and the cloud, in this layer fogbow requests are translated to specific cloud request format. The plugins that should be used by manager are configurable at manager configuration file. Currently, fogbow provides an implementation to OpenStack cloud.</p>
<p>Basicaly, the Manager is responsable for three diferent services:</p>
<ul>
<li><strong>Submiting open requests:</strong> it will submit all open requests periodically. It is possible that some user's requests were not have been fulfilled at previous submition, then the manager try to fulfill them periodically. The scheduler interval is configurable at manager configuration file;</li>
<li><strong>Monitoring of instances:</strong> it monitors request's instances. In this way, the manager identifies when a request's instance does not exist anymore and it updates request state according to request's attributes (possible request states can be seen here). The instance monitoring period is configurable at manager configuration file;</li>
<li><strong>Updating of requests's token:</strong> it updates request's token when it is needed. When a request was done by local cloud user, it knows the used access token. However this access token can expire before valid_until attribute or request be fulfilled. In this way, the manager updates the request's token when it is necessary. The token update period is configurable at manager configuration file.</li>
</ul>
<p>All communication is done via XMPP according to the Manager Protocol.</p>
<h2>Manager Protocol</h2>
<h3>Request Remote Instance</h3>
<h4>Request</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;set&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&quot;http://fogbowcloud.org/manager/request&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;category&gt;</span>
         <span class="nt">&lt;class&gt;</span>category-class1<span class="nt">&lt;/class&gt;</span>
         <span class="nt">&lt;term&gt;</span>category-term1<span class="nt">&lt;/term&gt;</span>
         <span class="nt">&lt;scheme&gt;</span>category-scheme1<span class="nt">&lt;/scheme&gt;</span>
      <span class="nt">&lt;/category&gt;</span>
      ...
      <span class="nt">&lt;category&gt;</span>
         <span class="nt">&lt;class&gt;</span>category-classN<span class="nt">&lt;/class&gt;</span>
         <span class="nt">&lt;term&gt;</span>category-termN<span class="nt">&lt;/term&gt;</span>
         <span class="nt">&lt;scheme&gt;</span>category-schemeN<span class="nt">&lt;/scheme&gt;</span>
      <span class="nt">&lt;/category&gt;</span>
      <span class="nt">&lt;attribute&gt;</span>
         <span class="nt">&lt;var&gt;</span>att-name1<span class="nt">&lt;/var&gt;</span>
         <span class="nt">&lt;value&gt;</span>att-value1<span class="nt">&lt;/value&gt;</span>
      <span class="nt">&lt;/attribute&gt;</span>
      ...
      <span class="nt">&lt;attribute&gt;</span>
         <span class="nt">&lt;var&gt;</span>att-nameN<span class="nt">&lt;/var&gt;</span>
         <span class="nt">&lt;value&gt;</span>att-valueN<span class="nt">&lt;/value&gt;</span>
      <span class="nt">&lt;/attribute&gt;</span>
   <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</pre></div>


<h4>Response</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;result&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&quot;http://fogbowcloud.org/manager/request&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;instance&gt;</span>
         <span class="nt">&lt;id&gt;</span>instance-id<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;/instance&gt;</span>
   <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</pre></div>


<h3>Get Remote Instance</h3>
<h4>Request</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;get&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&quot;http://fogbowcloud.org/manager/getinstance&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;instance&gt;</span>
         <span class="nt">&lt;id&gt;</span>instance-id<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;/instance&gt;</span>
   <span class="nt">&lt;/query&gt;</span>
</pre></div>


<h4>Response</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;result&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&quot;http://fogbowcloud.org/manager/getinstance&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;instance&gt;</span>
         <span class="nt">&lt;id&gt;</span>instance-id<span class="nt">&lt;/id&gt;</span>
         <span class="nt">&lt;link&gt;</span>
            <span class="nt">&lt;link&gt;</span>link-name<span class="nt">&lt;/link&gt;</span>
            <span class="nt">&lt;attribute</span> <span class="na">val=</span><span class="s">&quot;att-name1&quot;</span><span class="nt">&gt;</span>att-value1<span class="nt">&lt;/attribute&gt;</span>
            ...
            <span class="nt">&lt;attribute</span> <span class="na">val=</span><span class="s">&quot;att-nameN&quot;</span><span class="nt">&gt;</span>att-valueN<span class="nt">&lt;/attribute&gt;</span>
         <span class="nt">&lt;/link&gt;</span>
         <span class="nt">&lt;resource&gt;</span>
            <span class="nt">&lt;category&gt;</span>
               <span class="nt">&lt;class&gt;</span>category-class1<span class="nt">&lt;/class&gt;</span>
               <span class="nt">&lt;term&gt;</span>category-term1<span class="nt">&lt;/term&gt;</span>
               <span class="nt">&lt;scheme&gt;</span>category-scheme1<span class="nt">&lt;/scheme&gt;</span>
               <span class="nt">&lt;attribute&gt;</span>att-name1<span class="nt">&lt;/attribute&gt;</span>
               ...
               <span class="nt">&lt;attribute&gt;</span>att-nameN<span class="nt">&lt;/attribute&gt;</span>
               <span class="nt">&lt;action&gt;</span>action-name1<span class="nt">&lt;/acttion&gt;</span>
               ...
               <span class="nt">&lt;action&gt;</span>action-nameN<span class="nt">&lt;/acttion&gt;</span>
            <span class="nt">&lt;/category&gt;</span>
            <span class="nt">&lt;location&gt;</span>value<span class="nt">&lt;/location&gt;</span>
            <span class="nt">&lt;title&gt;</span>value<span class="nt">&lt;/title&gt;</span>
            <span class="nt">&lt;rel&gt;</span>value<span class="nt">&lt;/rel&gt;</span>
         <span class="nt">&lt;/resource&gt;</span>
         ...
         <span class="nt">&lt;resource&gt;</span>
            <span class="nt">&lt;category&gt;</span>
               <span class="nt">&lt;class&gt;</span>category-classN<span class="nt">&lt;/class&gt;</span>
               <span class="nt">&lt;term&gt;</span>category-termN<span class="nt">&lt;/term&gt;</span>
               <span class="nt">&lt;scheme&gt;</span>category-schemeN<span class="nt">&lt;/scheme&gt;</span>
               <span class="nt">&lt;attribute&gt;</span>att-name1<span class="nt">&lt;/attribute&gt;</span>
               ...
               <span class="nt">&lt;attribute&gt;</span>att-nameN<span class="nt">&lt;/attribute&gt;</span>
               <span class="nt">&lt;action&gt;</span>action-name1<span class="nt">&lt;/acttion&gt;</span>
               ...
               <span class="nt">&lt;action&gt;</span>action-nameN<span class="nt">&lt;/acttion&gt;</span>
            <span class="nt">&lt;/category&gt;</span>
            <span class="nt">&lt;location&gt;</span>value<span class="nt">&lt;/location&gt;</span>
            <span class="nt">&lt;title&gt;</span>value<span class="nt">&lt;/title&gt;</span>
            <span class="nt">&lt;rel&gt;</span>value<span class="nt">&lt;/rel&gt;</span>
         <span class="nt">&lt;/resource&gt;</span>
         <span class="nt">&lt;attribute</span> <span class="na">val=</span><span class="s">&quot;att-name1&quot;</span><span class="nt">&gt;</span>att-value1<span class="nt">&lt;/attribute&gt;</span>
         ...
         <span class="nt">&lt;attribute</span> <span class="na">val=</span><span class="s">&quot;att-nameN&quot;</span><span class="nt">&gt;</span>att-valueN<span class="nt">&lt;/attribute&gt;</span>
      <span class="nt">&lt;/instance&gt;</span>
   <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</pre></div>


<h3>Remove Remote Instance</h3>
<h4>Request</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;set&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&quot;http://fogbowcloud.org/manager/removeinstance&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;instance&gt;</span>
         <span class="nt">&lt;id&gt;</span>instance-id<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;/instance&gt;</span>
   <span class="nt">&lt;/query&gt;</span>
</pre></div>


<h4>Response</h4>
<div class="highlight"><pre><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&quot;result&quot;</span><span class="nt">/&gt;</span>
</pre></div>
      </div>
    </div>
    </div>
      </div>
    </div>
    
    <footer class="footer">
      <div class="container">
      <div class="row">
	  <div class="col-lg-12">
	    <ul class="list-inline">
	      <li class="pull-right"><a href="#top">Back to top</a></li>
	      <li><a href="http://blog.fogbowcloud.org">Blog</a></li>
	      <li><a href="https://github.com/fogbow/">GitHub</a></li>
	      <li><a href="http://build.fogbowcloud.org">Build status</a></li>
	    </ul>
	    <p>Code released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License Version 2.0</a>.</p>
	    <p>Based on <a href="http://getbootstrap.com" rel="nofollow">Bootstrap</a>. Icons from <a href="http://fortawesome.github.io/Font-Awesome/" rel="nofollow">Font Awesome</a>. Web fonts from <a href="http://www.google.com/webfonts" rel="nofollow">Google</a>.</p>
	  </div>
      </div>
      </div>
    </footer>

  </body>
</html>